jQuery(function(a){var w=0<ajaxurl.indexOf("?")?"&":"?",H={log:function(a){"undefined"!==console&&console.log(a)},info:function(a){"undefined"!==console&&console.info(a)}};a("#imagify-signup").click(function(b){b.preventDefault();swal({title:imagifyAdmin.labels.signupTitle,html:imagifyAdmin.labels.signupText,confirmButtonText:imagifyAdmin.labels.signupConfirmButtonText,input:"email",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,customClass:"imagify-sweet-alert imagify-sweet-alert-signup",
inputValidator:function(b){return new Promise(function(d,e){""!=a.trim(b)&&b?d():e(imagifyAdmin.labels.signupErrorEmptyEmail)})},preConfirm:function(b){return new Promise(function(d,e){setTimeout(function(){a.get(ajaxurl+w+"action=imagify_signup&email="+b+"&imagifysignupnonce="+a("#imagifysignupnonce").val()).done(function(a){a.success?d():e(a.data)})},2E3)})}}).then(function(a){swal({title:imagifyAdmin.labels.signupSuccessTitle,html:imagifyAdmin.labels.signupSuccessText,type:"success",customClass:"imagify-sweet-alert"})})});
a("#imagify-save-api-key").click(function(b){b.preventDefault();swal({title:imagifyAdmin.labels.saveApiKeyTitle,html:imagifyAdmin.labels.saveApiKeyText,confirmButtonText:imagifyAdmin.labels.saveApiKeyConfirmButtonText,input:"text",allowOutsideClick:!0,showLoaderOnConfirm:!0,customClass:"imagify-sweet-alert imagify-sweet-alert-signup",inputValidator:function(b){return new Promise(function(d,e){""!=a.trim(b)&&b?d():e(imagifyAdmin.labels.ApiKeyErrorEmpty)})},preConfirm:function(b){return new Promise(function(d,
e){a.get(ajaxurl+w+"action=imagify_check_api_key_validity&api_key="+b+"&imagifycheckapikeynonce="+a("#imagifycheckapikeynonce").val()).done(function(a){a.success?d():e(a.data)})})}}).then(function(a){swal({title:imagifyAdmin.labels.ApiKeyCheckSuccessTitle,html:imagifyAdmin.labels.ApiKeyCheckSuccessText,type:"success",customClass:"imagify-sweet-alert"})})});a(".imagify-notice-dismiss").click(function(b){b.preventDefault();var d=a(this);b=d.parents(".imagify-welcome, .imagify-notice");d=d.attr("href");
b.fadeTo(100,0,function(){a(this).slideUp(100,function(){a(this).remove()})});a.get(d.replace("admin-post.php","admin-ajax.php"))});a(".imagify-modal").attr("aria-hidden","true");a(".imagify-modal-trigger").on("click.imagify",function(){var b=a(this),b=b.data("target")||b.attr("href");a(b).css("display","flex").hide().fadeIn(400).attr("aria-hidden","false").attr("tabindex","0").focus().removeAttr("tabindex").addClass("modal-is-open");a("body").addClass("imagify-modal-is-open");return!1});a(document).on("click.imagify",
".imagify-modal .close-btn",function(){a(this).closest(".imagify-modal").fadeOut(400).attr("aria-hidden","true").removeClass("modal-is-open");a(this).closest(".imagify-modal").hasClass("imagify-payment-modal")&&(a(this).closest(".imagify-modal-content").removeClass("imagify-success-viewing imagify-iframe-viewing"),setTimeout(function(){a(".imagify-modal-views").hide();a("#imagify-pre-checkout-view").show()},300));a("body").removeClass("imagify-modal-is-open")}).on("blur.imagify",".imagify-modal .close-btn",
function(){var b=a(this).closest(".imagify-modal");"false"===b.attr("aria-hidden")&&b.attr("tabindex","0").focus().removeAttr("tabindex")});a(document).on("click.imagify",".imagify-modal",function(b){a(b.target).filter(".modal-is-open").find(".close-btn").trigger("click.imagify")});a(window).on("keydown.imagify",function(b){if(27==b.keyCode&&0<a(".imagify-modal.modal-is-open").length)return b.preventDefault(),a(".imagify-modal.modal-is-open").find(".close-btn").trigger("click.imagify"),!1});var x=
!1;a("#wp-admin-bar-imagify").hover(function(){if(!0!==x){x=!0;var b=a("#wp-admin-bar-imagify-profile-content");b.is(":empty")&&a.get(ajaxurl+w+"action=imagify_get_admin_bar_profile&imagifygetadminbarprofilenonce="+a("#imagifygetadminbarprofilenonce").val()).done(function(d){b.html(d.data);a("#wp-admin-bar-imagify-profile-loading").remove();x=!1})}});if(a("#imagify-pricing-modal").length){var y=a("#imagify-pricing-modal"),z=function(a,d){d||(d=null);output="";if("object"===typeof a){var b=a.yearly+
"",e=(a.monthly+"").split("."),b=b.split(".");output+='<span class="imagify-switch-my"><span aria-hidden="'+("monthly"===d?"false":"true")+'" class="imagify-monthly"><span class="imagify-price-big">'+e[0]+'</span> <span class="imagify-price-mini">.'+(1===e[1].length?e[1]+"0":(""+e[1]).substring(0,2))+'</span></span> <span aria-hidden="'+("yearly"===d?"false":"true")+'" class="imagify-yearly"><span class="imagify-price-big">'+b[0]+'</span> <span class="imagify-price-mini">.'+(1===b[1].length?b[1]+
"0":(""+b[1]).substring(0,2))+"</span></span></span>"}else e=(a+"").split("."),output+='<span class="imagify-price-big">'+e[0]+'</span> <span class="imagify-price-mini">.'+(1===e[1].length?e[1]+"0":(""+e[1]).substring(0,2))+"</span>";return output},I=function(a,d){d||(d=null);output="";return output="object"===typeof a?output+('<span class="imagify-price-discount"><span class="imagify-price-discount-dollar">$</span><span class="imagify-switch-my"><span aria-hidden="'+("monthly"===d?"false":"true")+
'" class="imagify-monthly"><span class="imagify-price-discount-number">'+(a.monthly+"")+'</span></span><span aria-hidden="'+("yearly"===d?"false":"true")+'" class="imagify-yearly"><span class="imagify-price-discount-number">'+(a.yearly+"")+"</span></span></span></span>"):output+('<span class="imagify-price-discount"><span class="imagify-price-discount-dollar">$</span><span class="imagify-price-discount-number">'+(a+"")+"</span></span>")},m=function(a,d,c,e){var b=window.imagify_discount_datas,f=d.additional_gb,
B=d.annual_cost,C=d.id,A=d.label,D=d.monthly_cost,l=d.quota;d=d.cost;var q=1E3<=l?l/1E3+" GB":l+" MB",h="monthly"===c?{monthly:D,yearly:Math.round(B/12*100)/100}:d,k=h;b.is_active&&"percentage"===b.coupon_type&&"monthly"===c&&(h=(100-b.coupon_value)/100,h="monthly"===c?{monthly:D*h,yearly:Math.round(B*h/12*100)/100}:d*h);"undefined"!==typeof e&&a.addClass("imagify-"+c+"-"+A+e);a.find(".imagify-offer-size").text(q);a.find(".imagify-number-block").html(z(h,"monthly"));b.is_active&&"percentage"===b.coupon_type&&
"monthly"===c&&(a.find(".imagify-price-block").prev(".imagify-price-discount").remove(),a.find(".imagify-price-block").before(I(k,"monthly")));a.find(".imagify-approx-nb").text(5*l);"monthly"===c&&a.find(".imagify-price-add-data").text("$"+f);(a.find(".imagify-payment-btn-select-plan").length?a.find(".imagify-payment-btn-select-plan"):a).attr("data-offer","monthly"===c?'{"'+A+'":{"id":'+C+',"name":"'+q+'","data":'+l+',"dataf":"'+q+'","imgs":'+5*l+',"prices":{"monthly":'+h.monthly+',"yearly":'+h.yearly+
',"add":'+f+"}}}":'{"ot'+A+'":{"id":'+C+',"name":"'+q+'","data":'+l+',"dataf":"'+q+'","imgs":'+5*l+',"price":'+h+"}}");return a},r=function(){var b=JSON.parse(a(".imagify-offer-monthly").attr("data-offer")),d=JSON.parse(a(".imagify-offer-onetime").attr("data-offer")),c=0,e=0;a(".imagify-offer-monthly").hasClass("imagify-offer-selected")&&(c=a("#imagify-subscription-monthly").filter(":checked").length?b[Object.keys(b)[0]].prices.monthly:12*b[Object.keys(b)[0]].prices.yearly);a(".imagify-offer-onetime").hasClass("imagify-offer-selected")&&
(e=d[Object.keys(d)[0]].price);b=parseFloat(e+c).toFixed(2);a(".imagify-global-amount").text(b);"0.00"==b||0===b?a("#imagify-modal-checkout-btn").attr("disabled","disabled").addClass("imagify-button-disabled"):a("#imagify-modal-checkout-btn").removeAttr("disabled").removeClass("imagify-button-disabled")},J=function(b){b=b.data("nonce");var d={action:"imagify_get_prices",imagifynonce:b},c={action:"imagify_get_images_counts",imagifynonce:b},e={action:"imagify_get_discount",imagifynonce:b};y.find(".imagify-modal-loader").hide().show();
a.post(ajaxurl,d,function(b){b.success&&a.post(ajaxurl,c,function(d){d.success&&a.post(ajaxurl,e,function(c){if(c.success){var e=d.data;prices_datas=b.data;promo_datas=c.data;monthlies=prices_datas.monthlies;onetimes=prices_datas.onetimes;mo_user_cons=Math.round(e.average_month_size.raw/1E6);ot_user_cons=Math.round(e.total_library_size.raw/1E6);$mo_tpl=a("#imagify-offer-monthly-template");$ot_tpl=a("#imagify-offer-onetime-template");ot_clone=$ot_tpl.html();mo_clone=$mo_tpl.html();mo_html=ot_html=
"";mo_suggested=ot_suggested=!1;$estim_block=a(".imagify-estimation-block");$estim_block.removeClass("imagify-analyzing");$estim_block.find(".average-month-size").text(e.average_month_size.human);$estim_block.find(".total-library-size").text(e.total_library_size.human);25>mo_user_cons&&25>ot_user_cons?(a(".imagify-pre-checkout-offers .imagify-modal-title").addClass("imagify-enough-free"),a(".imagify-offer-selected").removeClass("imagify-offer-selected").find(".imagify-checkbox").removeAttr("checked")):
(a(".imagify-enough-free").removeClass("imagify-enough-free"),a(".imagify-offer-selected").addClass("imagify-offer-selected").find(".imagify-checkbox").attr("checked","checked"));if(null===monthlies||null===onetimes)c=a(".imagify-pre-checkout-offers"),c.hide().attr("aria-hidden",!0),c.closest(".imagify-modal-views").find(".imagify-popin-message").remove(),c.after('<div class="imagify-popin-message imagify-error"><p>'+imagifyAdmin.labels.errorPriceAPI+"</p></div>");else{window.imagify_discount_datas=
promo_datas;if(promo_datas.is_active){c=a(".imagify-modal-promotion");var e=promo_datas.date_end.split("T")[0],f=promo_datas.coupon_value;discount="percentage"===promo_datas.coupon_type?f+"%":"$"+f;a("#imagify-coupon-code").val(promo_datas.label).attr("readonly",!0);c.addClass("active").attr("aria-hidden","false");c.find(".imagify-promotion-number").text(discount);c.find(".imagify-promotion-date").text(e);n()}a.each(monthlies,function(b,d){if("free"===d.label)return!0;var c=a(mo_clone).clone();if(!1!==
mo_suggested&&2<b-mo_suggested)return!0;classes="";if(mo_user_cons<d.quota&&!1===mo_suggested){classes=" imagify-offer-selected";mo_suggested=b;var e=a(".imagify-pre-checkout-offers").find(".imagify-offer-monthly");m(e,d,"monthly")}c=m(c,d,"monthly",classes);mo_html+=c[0].outerHTML});c=a(mo_html).filter(".imagify-offer-selected").prevAll();if(1<c.length){c=c.length-1;e=a(mo_html);for(i=0;i<c;i++)delete e[i];mo_html="";for(j=0;j<e.length;j++)mo_html+=a("<div/>").append(e[j]).html()}a.each(onetimes,
function(b,d){var c=a(ot_clone).clone(),e=a(".imagify-pre-checkout-offers").find(".imagify-offer-onetime");classes="";ot_user_cons<d.quota&&!1===ot_suggested&&(classes=" imagify-offer-selected",ot_suggested=!0,m(e,d,"onetime"));b===onetimes.length-1&&!1===ot_suggested&&m(e,onetimes[onetimes.length-1],"onetime");c=m(c,d,"onetime",classes);ot_html+=c[0].outerHTML});$mo_tpl.parent().find(".imagify-offer-line")&&$mo_tpl.parent().find(".imagify-offer-line").remove();$mo_tpl.before(mo_html);$ot_tpl.parent().find(".imagify-offer-line")&&
$ot_tpl.parent().find(".imagify-offer-line").remove();$ot_tpl.before(ot_html)}y.find(".imagify-modal-loader").fadeOut(300)}})});r()})},E=function(b){b.each(function(){a(this).is(":checked")?a(this).closest(".imagify-offer-line").addClass("imagify-offer-selected"):a(this).closest(".imagify-offer-line").removeClass("imagify-offer-selected")});r()},F=function(b){b.each(function(){var b=a(this),c;c=b.parent(".imagify-cart-list-switcher").length?b.closest(".imagify-cart"):b.parent(".imagify-small-options").length?
b.parent(".imagify-small-options").next(".imagify-pricing-table"):b.closest(".imagify-offer-line");var e=c.find(".imagify-switch-my");"yearly"===b.val()?(c.addClass("imagify-year-selected").removeClass("imagify-month-selected"),e.find(".imagify-monthly").attr("aria-hidden","true"),e.find(".imagify-yearly").attr("aria-hidden","false")):(c.addClass("imagify-month-selected").removeClass("imagify-year-selected"),e.find(".imagify-monthly").attr("aria-hidden","false"),e.find(".imagify-yearly").attr("aria-hidden",
"true"))});r();return b},n=function(){var b=a("#imagify-coupon-code").val();if(""!==b){var d=a(".imagify-coupon-text"),c=d.find("label"),e=a(".imagify-coupon-section"),g=a("#imagify-get-pricing-modal").data("nonce");d.addClass("checking");a.post(ajaxurl,{action:"imagify_check_coupon",coupon:b,imagifynonce:g},function(a){d.removeClass("checking");"false"===a.success?(c.text(imagifyAdmin.labels.errorCouponAPI),e.removeClass("validated").addClass("invalid")):a.data.success?(a="percentage"===a.data.coupon_type?
a.data.value+"%":"$"+a.data.value,e.removeClass("invalid").addClass("validated"),c.html(imagifyAdmin.labels.successCouponAPI),c.find(".imagify-coupon-offer").text(a),c.find(".imagify-coupon-word").text(b)):(e.removeClass("validated").addClass("invalid"),c.text(a.data.detail))})}},p=a(".imagify-offer-line").find(".imagify-checkbox"),G=a(".imagify-payment-modal").find(".imagify-radio-line").find("input");E(p);F(G.filter(":checked"));n();setInterval(function(){r()},1E3);p.on("change.imagify",function(){E(a(this))});
G.on("change.imagify",function(){F(a(this))});a("#imagify-get-pricing-modal").on("click.imagify-ajax",function(){J(a(this))});var u=a("#imagify-plans-selection-view"),k=a("#imagify-payment-process-view"),t=a("#imagify-pre-checkout-view"),v=a("#imagify-success-view"),p=a(".imagify-choose-another-plan");a("#imagify-coupon-code").on("blur.imagify",function(){a(this).attr("readonly")||n()}).on("keydown.imagify",function(b){if(!a(this).attr("readonly")){if(13===b.keyCode||32===b.keyCode)return n(),!1;
3<=a(this).val().length?a(this).closest(".imagify-coupon-input").addClass("imagify-canbe-validate"):a(this).closest(".imagify-coupon-input").removeClass("imagify-canbe-validate")}});a("#imagify-coupon-validate").on("click.imagify",function(){n();a(this).closest(".imagify-canbe-validate").removeClass("imagify-canbe-validate")});u.hide();k.hide();v.hide();p.on("click.imagify",function(){var b=a(this),d=b.data("imagify-choose");b.closest(".imagify-modal-views").hide().attr("aria-hidden","true");k.hide().attr("aria-hidden",
"true");u.fadeIn(300).attr("aria-hidden","false");var c=setInterval(function(){u.find('a[href="#imagify-pricing-tab-'+("plan"==d?"monthly":"onetime")+'"]').trigger("click.imagify");clearInterval(c);c=null},60);return!1});y.on("click.imagify",".imagify-payment-btn-select-plan",function(){var b=a(this),d=b.closest(".imagify-offer-line"),c=b.data("offer"),e=b.attr("data-offer"),g="imagify-pricing-tab-monthly"===b.closest(".imagify-tab-content").attr("id")?!1:!0,f=g?t.find(".imagify-offer-onetime"):t.find(".imagify-offer-monthly"),
b=g?null:b.closest(".imagify-pricing-table").hasClass("imagify-month-selected")?"monthly":"yearly",c=g?z(c[Object.keys(c)[0]].price):z(c[Object.keys(c)[0]].prices,b),k=d.find(".imagify-price-discount").html(),m=d.find(".imagify-approx-nb").text(),n=d.find(".imagify-offer-size").text(),p=g?"":'<span class="imagify-price-by">'+d.find(".imagify-price-by").text()+"</span>";u.hide().attr("aria-hidden","true");t.fadeIn(300).attr("aria-hidden","false");f.find(".imagify-number-block").html(c+p);f.find(".imagify-price-discount").html(k);
f.find(".imagify-approx-nb").text(m);f.find(".imagify-offer-size").text(n);f.attr("data-offer",e);g||(f.find(".imagify-price-add-data").text(d.find(".imagify-price-add-data").text()),"monthly"===b?f.find("#imagify-subscription-monthly").trigger("click.imagify"):f.find("#imagify-subscription-yearly").trigger("click.imagify"),f.find(".imagify-inline-options").find("input:radio:checked").trigger("change.imagify"));r();return!1});a("#imagify-modal-checkout-btn").on("click.imagify",function(){if(!a(this).hasClass("imagify-button-disabled")){var b=
a(".imagify-offer-monthly"),d=a(".imagify-offer-onetime"),c={};b.hasClass("imagify-year-selected");b.hasClass("imagify-offer-selected")?(c.monthly=JSON.parse(b.attr("data-offer")),a(".imagify-cart-list-my-choice").show(),prices=c.monthly[Object.keys(c.monthly)[0]].prices,save_price=Math.round(1200*(prices.monthly-prices.yearly))/100,a(".imagify-nb-save-per-year").text("$"+save_price)):a(".imagify-cart-list-my-choice").hide();d.hasClass("imagify-offer-selected")&&(c.onetime=JSON.parse(d.attr("data-offer")));
t.hide().attr("aria-hidden","true");k.fadeIn(300).attr("aria-hidden","false").closest(".imagify-modal-content").addClass("imagify-iframe-viewing");c.period=a(".imagify-offer-monthly").hasClass("imagify-month-selected")?"monthly":"yearly";var b=a("#imagify-payment-iframe"),e=b.attr("src"),d=b.data("src"),g=0,f=0;"object"===typeof c?(c.monthly&&(g=c.monthly[Object.keys(c.monthly)[0]].id),c.onetime&&(f=c.onetime[Object.keys(c.onetime)[0]].id,f=999==f?c.onetime[Object.keys(c.onetime)[0]].data:f),c.period?
(a("#imagify-payment-iframe").data("imagify-api"),e=f,f="yearly"===c.period?g:0,c="monthly"===c.period?g:0,g=a("#imagify-coupon-code").val(),g=""===g?"none":g,parseFloat(a(".imagify-global-amount").text()).toFixed(2),d=d+e+"/"+c+"/"+f+"/"+g+"/",$iframeClone=b.clone(),b.remove(),$iframeClone.attr("src",d),k.html($iframeClone)):H.info("No period defined")):"string"===typeof c&&""!==e&&(tofind="monthly"===c?"yearly":"monthly",e=e.replace(tofind,c),b.attr("src",e));return!1}});a(".imagify-back-to-plans").on("click.imagify",
function(){a(this).closest(".imagify-cart-item").hasClass("imagify-cart-item-onetime")?a(".imagify-offer-onetime").find(".imagify-choose-another-plan").trigger("click.imagify"):a(".imagify-offer-monthly").find(".imagify-choose-another-plan").trigger("click.imagify");return!1});window.addEventListener("message",function(b){var d=b.origin||b.originalEvent.origin;if("https://app.imagify.io"===d||"http://dapp.imagify.io"===d)switch(b.data){case "cancel":a(".imagify-iframe-viewing .close-btn").trigger("click.imagify");
a(".imagify-iframe-viewing").removeClass("imagify-iframe-viewing");break;case "back":a(".imagify-iframe-viewing").removeClass("imagify-iframe-viewing");k.hide();t.fadeIn(200);break;case "success":a(".imagify-iframe-viewing").removeClass("imagify-iframe-viewing"),k.hide(),v.closest(".imagify-modal-content").addClass("imagify-success-viewing"),v.closest(".imagify-modal").attr("aria-labelledby","imagify-success-view"),v.fadeIn(200)}},!0)}if(a(".imagify-tabs").length)a(".imagify-tab").on("click.imagify",
function(){var b=a(this);if(!b.hasClass("imagify-current")){var d=b.find("a").attr("href")||"#"+b.find("a").attr("aria-controls");b.closest(".imagify-tabs").next(".imagify-tabs-contents").find(".imagify-tab-content").hide().attr("aria-hidden","true");a(d).fadeIn(275).attr("aria-hidden","false");b.closest(".imagify-tabs").find(".imagify-tab").removeClass("imagify-current").attr("aria-selected","false");b.addClass("imagify-current").attr("aria-selected","true")}return!1})});